(function(){mui.init();var deceleration=mui.os.ios?.003:9e-4;var pageSize=10,pageNos={pageNo1:1,pageNo2:1,pageNo3:1,pageNo4:1},canPulls={canPull1:true,canPull2:true,canPull3:true,canPull4:true};var currentid=1;var clocation={};var dsid="";var ptid="";var dname="";var pname="";var page={init:function(){base.setPageRem();mui.plusReady(function(){clocation=getQueryString("location");dsid=getQueryString("dsid");ptid=getQueryString("ptid");dname=getQueryString("dname");pname=getQueryString("pname");page.dqwzxs();page.queryList(1);page.bind()})},queryList:function(type,upOrdown){var qurl="";var qdata={};if(type==1){if(clocation==undefined||clocation==null||clocation==""){qurl=Constants.rentlist}else{qurl=Constants.fjzf}}if(type==2){if(clocation==undefined||clocation==null||clocation==""){qurl=Constants.salelist}else{qurl=Constants.fjesf}}if(type==3){if(clocation==undefined||clocation==null||clocation==""){qurl=Constants.crowdfundlist}else{qurl=Constants.fjzcouf}}if(type==4){if(clocation==undefined||clocation==null||clocation==""){qurl=Constants.newhouselist}else{qurl=Constants.fjxf}}if(clocation==undefined||clocation==null||clocation==""){if(upOrdown==2||upOrdown==undefined){qdata={"parameters[cityID]":locgetuserinfo("cityid"),"parameters[districtID]":dsid,"parameters[platID]":ptid,"pager.pageSize":pageSize,"pager.pageNo":page.getPageNo(type)}}else{qdata={"parameters[cityID]":locgetuserinfo("cityid"),"parameters[districtID]":dsid,"parameters[platID]":ptid,"pager.pageSize":pageSize,"pager.pageNo":1}}}else{if(upOrdown==2||upOrdown==undefined){qdata={"parameters[longitude]":Math.floor(clocation.longitude*1e6)/1e6,"parameters[latitude]":Math.floor(clocation.latitude*1e6)/1e6,"pager.pageSize":pageSize,"pager.pageNo":page.getPageNo(type)}}else{qdata={"parameters[longitude]":Math.floor(clocation.longitude*1e6)/1e6,"parameters[latitude]":Math.floor(clocation.latitude*1e6)/1e6,"pager.pageSize":pageSize,"pager.pageNo":1}}}var querySettings={url:qurl,data:qdata,type:"post"};muiAjax(querySettings,function(data){var rows=data.rows;var rentlength=rows.length,totalLength=data.totalRows;if(rows.length>0){if(rentlength<pageSize){page.setCanPull(type,false)}else if(totalLength==pageSize*(page.getPageNo(type)-1)+rentlength){page.setCanPull(type,false)}else{page.setCanPull(type,true)}var obj;var tmpl=mui("#rows-li-template"+currentid)[0].innerHTML;var fragment=document.createDocumentFragment();var div=document.createElement("div");if(currentid==3){obj={rows:rows,syz:function(){return this.totalPrice-this.atualInvestment}}}else{obj={rows:rows}}div.innerHTML=Mustache.render(tmpl,obj);while(div.hasChildNodes()){fragment.appendChild(div.firstChild)}mui("#guessUlike"+currentid)[0].appendChild(fragment)}else{page.setCanPull(false)}},function(status){})},getPageNo:function(currentid){if(currentid==1){return pageNos.pageNo1}if(currentid==2){return pageNos.pageNo2}if(currentid==3){return pageNos.pageNo3}if(currentid==4){return pageNos.pageNo4}},setPageNo:function(currentid,adds){if(currentid==1){pageNos.pageNo1+=adds}if(currentid==2){pageNos.pageNo2+=adds}if(currentid==3){pageNos.pageNo3+=adds}if(currentid==4){pageNos.pageNo4+=adds}},getCanPull:function(currentid){if(currentid==1){return canPulls.canPull1}if(currentid==2){return canPulls.canPull2}if(currentid==3){return canPulls.canPull3}if(currentid==4){return canPulls.canPull4}},setCanPull:function(currentid,flag){if(currentid==1){canPulls.canPull1=flag}if(currentid==2){canPulls.canPull2=flag}if(currentid==3){canPulls.canPull3=flag}if(currentid==4){canPulls.canPull4=flag}},bind:function(){mui(".ms-header-menu").on("tap",".ms-m",function(){switchTab(this)});mui.each(document.querySelectorAll(".mysign-content"),function(index,pullRefreshEl){mui(pullRefreshEl).pullToRefresh({down:{callback:function(){var self=this;setTimeout(function(){page.queryList(currentid,1);self.endPullDownToRefresh()},500)}},up:{callback:function(){var self=this;setTimeout(function(){if(page.getCanPull(currentid)){page.setPageNo(currentid,1);page.queryList(currentid,2)}self.endPullUpToRefresh(!page.getCanPull(currentid))},500)}}});mui(pullRefreshEl).pullToRefresh().pullUpTipsIcon.innerHTML=""});var muiBack=mui(".mui-back")[0];mui(document).on("tap",".slider-menu-choose li",function(){var cLocation=mui(".choose-location")[0];if(cLocation.style.display=="none"){base.Slider.slideDown(cLocation,100);muiBack.style.display="block"}else{base.Slider.slideUp(cLocation,100);muiBack.style.display="none"}}).on("tap","#guessUlike li",function(){var id=this.getAttribute("data-id");var pageObj={pageUrl:"newhousedetail.html?houseid="+id};pageChange(pageObj)})},dqwzxs:function(){var tpl={container:"#dqwz",template:"#dqwztmpl",obj:{rows:{pname:pname,dname:dname}}};getTemplate(tpl)}};function switchTab($this){currentid=parseInt($this.getAttribute("data-type"));base.removeClass(base.$s(".ms-m"),"ms-menu-active");base.addClass($this,"ms-menu-active");base.removeClass(base.$(".section-active"),"section-active");base.addClass(base.$(".ms-con"+currentid),"section-active");if(mui("#guessUlike"+currentid)[0].childNodes.length<2){page.queryList(currentid)}}page.init()})();